"![crackle](https://raw.github.com/mikeryan/crackle/logo/crackle.png \"crackle\")\n\ncrackle cracks BLE Encryption (AKA Bluetooth Smart).\n\ncrackle exploits a flaw in the BLE pairing process that allows an\nattacker to guess or very quickly brute force the TK (Temporary Key).\nWith the TK and other data collected from the pairing process, the STK\n(Short Term Key) and later the LTK (Long Term Key) can be collected.\n\nWith the STK and LTK, all communications between the master and the\nslave can be decrypted.\n\nBefore attempting to use crackle, review the [FAQ](FAQ.md) to determine\nwhether it is the appropriate tool to use in your situation.\n\ncrackle was written by Mike Ryan <mikeryan@lacklustre.net>\nSee web site for more info:\n    http://lacklustre.net/projects/crackle/\n\n![Build Status](https://travis-ci.org/mikeryan/crackle.svg?branch=master \"Build Status\")\n\nTable of Contents\n=================\n\n - Modes of Operation\n    - Crack TK\n    - Decrypt with LTK\n - Running crackle\n - Sample Files\n - Frequently Asked Questions\n - See Also\n - Thanks\n\n\nModes of Operation\n==================\n\ncrackle has two major modes of operation: Crack TK and Decrypt with LTK.\n\nCrack TK\n--------\n\nThis is the default mode used when providing crackle with an input file\nusing ```-i```.\n\nIn Crack TK mode, crackle brute forces the TK used during a BLE pairing\nevent. crackle exploits the fact that the TK in Just Works(tm) and\n6-digit PIN is a value in the range [0,999999] padded to 128 bits.\n\ncrackle employs several methods to perform this brute force: a very fast\nmethod if all pairing packets are present in the input file, and a slow\nmethod if a minimum set of packets is present.\n\nTo use this mode, launch crackle with an input PCAP or PcapNG file\ncontaining one or more connections with a BLE pairing conversation.\ncrackle will analyze all connections, determine whether it is possible\nto crack a given connection, and automatically choose the best strategy\nto crack each one.\n\nIf the TK successfully cracks, crackle will derive the remaining keys\nused to encrypt the rest of the connection and will decrypt any\nencrypted packets that follow. If the LTK is exchanged (typically the\nfirst thing done after encryption is established) crackle will output\nthis value to stdout. The LTK can be used to decrypt any future\ncommunications between the two endpoints.\n\nProvide crackle with an output file using ```-o``` to create a new PCAP\nfile containing the decrypted data (in addition to the already\nunencrypted data).\n\nExample usage:\n\n    $ crackle -i input.pcap -o decrypted.pcap\n\n\nDecrypt with LTK\n----------------\n\nIn Decrypt with LTK mode, crackle uses a user-supplied LTK to decrypt\ncommunications between a master and slave. This mode is identical to the\ndecryption portion of Crack TK mode.\n\nExample usage:\n\n    $ crackle -i encrypted.pcap -o decrypted.pcap -l 81b06facd90fe7a6e9bbd9cee59736a7\n\n\nRunning Crackle\n===============\n\nCrack TK Mode\n-------------\n\nIn Crack TK mode, crackle requires a PCAP file that contains a BLE\npairing event. The best way to generate such a file is to use an\nUbertooth to capture a pairing event between a master and a slave.\n\nTo check if your PCAP file contains all the necessary packets, run\ncrackle with the -i option:\n\n    crackle -i <file.pcap>\n\ncrackle will analyze each connection in the input file and output the\nresults of its analysis to stdout. If you have all the components of a\npairing conversation, the output will look like this:\n\n    Analyzing connection 0:\n      xx:xx:xx:xx:xx:xx (public) -> yy:yy:yy:yy:yy:yy (public)\n      Found 13 encrypted packets\n\n      Cracking with strategy 0, 20 bits of entropy\n\n      !!!\n      TK found: 412741\n      !!!\n\n      Decrypted 12 packets\n      LTK found: 81b06facd90fe7a6e9bbd9cee59736a7\n\n    Specify an output file with -o to decrypt packets!\n\nTo decrypt all packets, add the -o option:\n\n    crackle -i <file.pcap> -o <output.pcap>\n\nThe output file will contain decrypted versions of all the encrypted\npackets from the original PCAP, as well as all the unencrypted packets.\nNote that CRCs are not recalculated, so the CRCs of decrypted packets\nwill be incorrect.\n\nDecrypt with LTK\n----------------\n\nIn Decrypt with LTK mode, crackle requires a PCAP file that contains at\na minimum LL_ENC_REQ and LL_ENC_RSP packets and the LTK used to encrypt\nthe communications.\n\nThe format for LTK is a 128 bit hexadecimal number with no spaces or\nseparators, most-significant octet to least-significant octet. Example:\n\n    -l 81b06facd90fe7a6e9bbd9cee59736a7\n\nTo check if your PCAP file contains all the necessary packets, run\ncrackle with -i and -l:\n\n    crackle -i <file.pcap> -l <ltk>\n\nIf you have both of the required packets, the program should produce\noutput similar to this:\n\n    Analyzing connection 0:\n      xx:xx:xx:xx:xx:xx (public) -> yy:yy:yy:yy:yy:yy (public)\n      Found 9 encrypted packets\n      Decrypted 6 packets\n\n    Specify an output file with -o to decrypt packets!\n\nTo decrypt all packets, add the -o option:\n\n    crackle -i <file.pcap> -o <out.pcap> -l <ltk>\n\nThe output file will be produced similarly to the output file described\nabove.\n\n\nSample Files\n============\n\nThe test files included in the ```tests``` directory serve as\ninteresting input for playing with crackle. Review the README files\nincluded in each test's subdirectory.\n\nGrab some sample files for cracking with crackle. Refer to the README\ninside the tarball for more information:\n\nhttps://lacklustre.net/bluetooth/crackle-sample.tgz\n\n\nFrequently Asked Questions\n==========================\n\nWe have compiled a list of [Frequently Asked Questions](FAQ.md).\n\n\nSee Also\n========\n\n - Ubertooth: http://ubertooth.sourceforge.net/\n - libbtbb: http://libbtbb.sourceforge.net/\n - #ubertooth on irc.freenode.net\n\n\nThanks\n======\n\nMajor thanks go to Mike Ossmann and Dominic Spill from the Ubertooth\nproject. None of this would be possible without them.\n\nBig time thanks go to Mike Kershaw/dragorn of Kismet for help creating\nand working with PCAP files.\n\nThanks go to the rest of #ubertooth on irc.freenode.net.\n"